<div class="c33 c73"><h1 class="c75" id="h.iffy9pom4o3c"><span class="c52 c23">Continuous Integration using </span><span class="c52 c23 c8">CircleCI</span><span class="c23 c52">&nbsp;for Android</span></h1><p class="c0"><span class="c12 c48"></span></p><p class="c57"><span class="c22">Create a </span><span class="c23">circle.yml</span><span class="c12 c22">&nbsp;in your project&rsquo;s root directory. If this file exists, CircleCI will read it each time it runs a build.</span></p><p class="c0 c47"><span class="c12 c22"></span></p><ul class="c24 lst-kix_n0u64i5tioth-0 start"><li class="c44"><h1 id="h.c1ghfp6t0jeh" style="display:inline"><span class="c52 c23">Enable </span><span class="c52 c23 c8 c62">CircleCI</span></h1></li></ul><ol class="c24 lst-kix_pjmou53ecp33-0 start" start="1"><li class="c39"><h1 id="h.ihxi9oifn6bv" style="display:inline"><span class="c22">Login on CircleCI </span><span class="c55 c33 c36"><a class="c19" href="https://www.google.com/url?q=https://circleci.com/&amp;sa=D&amp;ust=1492671534579000&amp;usg=AFQjCNELAbe6Nh_TiY9Jc7ZPEQdqLXLzgA">https://circleci.com/</a></span><span class="c12 c22">&nbsp; -&gt; Log In with bitbucket or Log In with GitHub</span></h1></li><li class="c29 c72"><span class="c12 c48">Follow the project on which you want Circle CI to run.</span></li></ol><p class="c57 c47"><span class="c60 c42">Note :</span><span>&nbsp; To follow the project, you have to be admin. &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span></p><p class="c0 c47"><span class="c12 c22"></span></p><p class="c0 c47"><span class="c12 c22"></span></p><ul class="c24 lst-kix_n0u64i5tioth-0"><li class="c44"><h1 id="h.ja009fe2zkh4" style="display:inline"><span class="c52 c23">Configuring </span><span class="c52 c23 c8">CircleCI</span></h1></li></ul><ol class="c24 lst-kix_60m7zrvjlgl0-0 start" start="1"><li class="c5"><h2 id="h.ik66d25vhes7" style="display:inline"><span class="c49 c23">File Structure and content</span></h2></li></ol><h1 class="c53" id="h.4yra6l6qeumr"><span class="c22">The </span><span class="c33 c54 c23">circle.yml</span><span class="c22">&nbsp;file has seven primary sections. Each section represents a </span><span class="c22 c8">phase</span><span class="c12 c22">&nbsp;of the Build-Test-Deploy process:</span></h1><ul class="c24 lst-kix_ql554y1er03f-0 start"><li class="c14 c34"><span class="c20">machine</span><span class="c1">:</span><span class="c12 c4">&nbsp;adjust the behavior of the virtual machine (VM)</span></li><li class="c14 c34"><span class="c20">checkout</span><span class="c1">:</span><span class="c12 c4">&nbsp;checkout and clone code from a repository</span></li><li class="c14 c34"><span class="c20">dependencies</span><span class="c1">:</span><span class="c12 c4">&nbsp;install your project&rsquo;s language-specific dependencies</span></li><li class="c14 c34"><span class="c20">database</span><span class="c1">: </span><span class="c12 c4">prepare a database for tests</span></li><li class="c14 c34"><span class="c20">compile</span><span class="c1">:</span><span class="c12 c4">&nbsp;compile your project</span></li><li class="c14 c34"><span class="c20">test</span><span class="c1">:</span><span class="c12 c4">&nbsp;run your tests</span></li><li class="c14 c34"><span class="c20">deployment</span><span class="c1">:</span><span class="c12 c4">&nbsp;deploy your code to your web servers</span></li></ul><p class="c27 c46"><span class="c22">A </span><span class="c33 c23 c54">circle.yml</span><span class="c12 c22">&nbsp;can also contain 2 optional sections that are not linked to specific phases:</span></p><ul class="c24 lst-kix_92my0so9chl5-0 start"><li class="c14 c34"><span class="c20">general</span><span class="c20 c36">:</span><span class="c12 c4">&nbsp;use for broader build-related configuration</span></li><li class="c14 c34"><span class="c20">experimental</span><span class="c20 c36">:</span><span class="c4 c12">&nbsp;test out features that are currently in development</span></li></ul><p class="c2 c25 c74"><span class="c12 c4"></span></p><p class="c63 c46"><span class="c12 c22">Each section consists of settings and/or Bash commands, which are run in the order they appear in the file.</span></p><p class="c63 c46"><span class="c12 c22">On completion, each command will return an exit code: 0 is a success, and any other number is a failure.</span></p><p class="c63 c46"><span class="c20 c36 c8">Note :</span><span class="c22">&nbsp;If a command fails during any of the setup sections (</span><span class="c33 c23">machine</span><span class="c22">, </span><span class="c33 c23">checkout</span><span class="c22">, </span><span class="c33 c23">dependencies</span><span class="c22">, </span><span class="c33 c23">database</span><span class="c22">, </span><span class="c33 c23">compile</span><span class="c22">), the entire build will fail early. If a command fails in the </span><span class="c33 c23">test</span><span class="c12 c22">&nbsp;section, the build will continue to run.</span></p><p class="c63 c46"><span class="c12 c22">You can specify when to run custom commands relative to CircleCI&rsquo;s inferred commands using three special keys:</span></p><ul class="c24 lst-kix_5o383sw7q7l3-0 start"><li class="c14 c61"><span class="c21">pre</span><span class="c33 c36 c45">:</span><span class="c4">&nbsp;run </span><span class="c4 c8">before</span><span class="c12 c4">&nbsp;inferred commands</span></li><li class="c14 c61"><span class="c21">override</span><span class="c33 c36 c45">:</span><span class="c4">&nbsp;run </span><span class="c4 c8">instead of</span><span class="c12 c4">&nbsp;inferred commands</span></li><li class="c14 c61"><span class="c21">post</span><span class="c33 c36 c45">:</span><span class="c4">&nbsp;run </span><span class="c4 c8">after</span><span class="c12 c4">&nbsp;inferred commands</span></li></ul><p class="c14 c25"><span class="c12 c4"></span></p><ol class="c24 lst-kix_60m7zrvjlgl0-0" start="2"><li class="c5"><h2 id="h.gkp15pw8belu" style="display:inline"><span class="c23 c49">Machine configuration</span></h2></li></ol><a id="t.6402ef70b85901d14bf01176b74b212370450dda"></a><a id="t.0"></a><table class="c38"><tbody><tr class="c31"><td class="c16" colspan="1" rowspan="1"><p class="c2"><span class="c21 c30">machine</span><span class="c12 c9">:</span></p><p class="c2"><span class="c9 c60">&nbsp; &nbsp; </span><span class="c21 c30">environment</span><span class="c35 c9 c60">:</span></p><p class="c2"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c21 c30">&nbsp;ANDROID_HOME:</span><span class="c12 c9">&nbsp;/usr/local/android-sdk-linux</span></p></td></tr></tbody></table><p class="c63 c47"><span class="c20 c36">Note :</span><span class="c33 c36 c43">&nbsp;</span><span class="c33 c60 c23">pre</span><span class="c22">&nbsp;and </span><span class="c33 c60 c23">post</span><span class="c22">&nbsp;are supported in the </span><span class="c33 c23">machine</span><span class="c22">&nbsp;section, </span><span class="c33 c60 c23">override</span><span class="c12 c22">&nbsp;is not.</span></p><p class="c25 c47 c63"><span class="c12 c22"></span></p><ol class="c24 lst-kix_60m7zrvjlgl0-0" start="3"><li class="c5"><h2 id="h.ml6qkgfovt62" style="display:inline"><span class="c49 c23">Checkout configuration</span></h2></li></ol><a id="t.ae817029e88b5578542948c5280ba96324b68c60"></a><a id="t.1"></a><table class="c64"><tbody><tr class="c31"><td class="c77" colspan="1" rowspan="1"><p class="c2"><span class="c10">checkout:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; post:</span></p><p class="c2"><span class="c18 c8">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c12 c9">- git submodule sync</span></p><p class="c2"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp;- git submodule update --init </span></p></td></tr></tbody></table><p class="c63 c47"><span class="c20 c36">Note :</span><span class="c43 c33 c36">&nbsp;</span><span class="c33 c23">only</span><span class="c22">&nbsp;</span><span class="c33 c23 c60">post</span><span class="c22">&nbsp;is supported in the </span><span class="c33 c23">this</span><span class="c12 c22">&nbsp;section because we don&rsquo;t read circle.yml until after the checkout phase.</span></p><p class="c63 c25 c47"><span class="c12 c22"></span></p><p class="c63 c25 c47"><span class="c12 c22"></span></p><ol class="c24 lst-kix_60m7zrvjlgl0-0" start="4"><li class="c5"><h2 id="h.sal0h445ch2p" style="display:inline"><span class="c7">Dependencies configuration</span></h2></li></ol><p class="c29"><span class="c12 c22">CircleCI automatically runs commands to fetch dependencies.</span></p><p class="c29 c25"><span class="c12 c22"></span></p><a id="t.a901df14d23efdc27f4ed0df7c753ad725ab9e5b"></a><a id="t.2"></a><table class="c17"><tbody><tr class="c69"><td class="c71" colspan="1" rowspan="1"><p class="c2"><span class="c12 c21 c32">dependencies:</span></p><p class="c2"><span class="c12 c21 c32">&nbsp; &nbsp; &nbsp; pre:</span></p><p class="c2"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp; - echo y | android update sdk --no-ui --all --filter &quot;platform-tools,build-tools-25.0.2,android-25,sys-img-armeabi-v7a-android-25,extra-andr</span><span class="c9">oid-support,extra-google-google_play_services,extra-google-m2repository,extra-android-m2repositor</span><span class="c9">y&quot;</span></p></td></tr></tbody></table><p class="c0"><span class="c12 c48"></span></p><p class="c0"><span class="c12 c48"></span></p><ol class="c24 lst-kix_60m7zrvjlgl0-0" start="5"><li class="c5"><h2 id="h.878rq16p7e5c" style="display:inline"><span class="c7">Compile configuration</span></h2></li></ol><p class="c29"><span class="c22">You can customize your project&rsquo;s build in the </span><span class="c23">compile</span><span class="c22">&nbsp;section of </span><span class="c23">circle.yml</span><span class="c12 c22">.</span></p><p class="c28 c25"><span class="c12 c22"></span></p><a id="t.d487306cbeb125490956edf3d27c5229d4cbd6ca"></a><a id="t.3"></a><table class="c11"><tbody><tr class="c31"><td class="c37" colspan="1" rowspan="1"><p class="c2"><span class="c10">compile:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; override:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c50 c18 c8"># Generate a debug-apk</span></p><p class="c2"><span class="c18 c8">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c9">- ./gradlew assembleDebug</span></p></td></tr></tbody></table><p class="c0"><span class="c12 c22"></span></p><p class="c0"><span class="c12 c22"></span></p><ol class="c24 lst-kix_60m7zrvjlgl0-0" start="6"><li class="c5"><h2 id="h.4pecygeg1lmt" style="display:inline"><span class="c7">Test configuration</span></h2></li></ol><p class="c29"><span class="c12 c22">All test commands will run, even if one fails.</span></p><p class="c28 c25"><span class="c12 c22"></span></p><a id="t.1187d1ceec017de41cb97741ae9a482c9ac514a4"></a><a id="t.4"></a><table class="c11"><tbody><tr class="c31"><td class="c37" colspan="1" rowspan="1"><p class="c2"><span class="c10">test:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; post:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c12 c9">- mkdir $CIRCLE_ARTIFACTS/apks</span></p><p class="c2"><span class="c12 c9">&nbsp; &nbsp; &nbsp; &nbsp; - curl -L -o gdrive &quot;https://docs.google.com/uc?id=0B3X9GlR6EmbnQ0FtZmJJUXEyRTA&amp;export=download&quot;; chmod +x gdrive</span></p><p class="c2"><span class="c12 c9">&nbsp; &nbsp; &nbsp; &nbsp; - ./gdrive --refresh-token &quot;${GDRIVE_REFRESH_TOKEN}</span></p><p class="c2"><span class="c12 c9">&quot; upload --parent &quot;${GDRIVE_DIR_ID}&quot; app/build/outputs/apk/app-debug.apk</span></p></td></tr></tbody></table><p class="c28 c25"><span class="c12 c22"></span></p><p class="c0"><span class="c12 c48"></span></p><ol class="c24 lst-kix_60m7zrvjlgl0-0" start="7"><li class="c5"><h2 id="h.90xyeh2wi2kj" style="display:inline"><span class="c7">Deployment configuration</span></h2></li></ol><p class="c29"><span class="c12 c22">The deployment section is optional. You can run commands to deploy to staging or production. These commands are triggered only after a successful (green) build.</span></p><p class="c0"><span class="c12 c22"></span></p><p class="c0"><span class="c12 c22"></span></p><a id="t.2635fb0c210bcff77d9155499ed1c57a643efef6"></a><a id="t.5"></a><table class="c11"><tbody><tr class="c31"><td class="c37" colspan="1" rowspan="1"><p class="c2"><span class="c10">deployment:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp;beta:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp;branch: </span><span class="c12 c9">Production</span></p><p class="c2"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">commands:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c9">- fastlane android beta</span></p></td></tr></tbody></table><p class="c28 c25"><span class="c12 c48"></span></p><p class="c29"><span class="c22">In the following example, if a developer pushes to the </span><span class="c15 c8">Production</span><span class="c22">&nbsp;branch, the command </span><span class="c15 c8">fastlane android beta</span><span class="c9">&nbsp;</span><span class="c22">runs</span><span class="c12 c9">.</span></p><p class="c28 c25"><span class="c12 c9"></span></p><p class="c47 c57"><span class="c36 c60 c42">Note :</span><span class="c36">&nbsp;</span><span class="c22">The </span><span class="c36 c23">deployment</span><span class="c22">&nbsp;section doesn&rsquo;t support sub-sections such as </span><span class="c36 c8 c42">pre</span><span class="c22">&nbsp;that you might find elsewhere in </span><span class="c36 c23">circle.yml</span><span class="c12 c22">.</span></p><p class="c0 c47"><span class="c12 c22"></span></p><p class="c0 c47"><span class="c12 c22"></span></p><ol class="c24 lst-kix_60m7zrvjlgl0-0" start="8"><li class="c5"><h2 id="h.hrurphs8y9dt" style="display:inline"><span class="c7">Tags configuration in Deployment</span></h2></li></ol><p class="c29"><span class="c22">In addition to deploying based on </span><span class="c33 c23">branch</span><span class="c12 c22">, you can deploy based on tags.</span></p><p class="c28 c25"><span class="c12 c22"></span></p><a id="t.256f717230e7e3874bf33d8a53bb65780a61ffd5"></a><a id="t.6"></a><table class="c11"><tbody><tr class="c31"><td class="c37" colspan="1" rowspan="1"><p class="c2"><span class="c10">deployment:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp;beta:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp;tag: </span><span class="c9">/release-.*/</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp;owner: </span><span class="c12 c9">circleci</span></p><p class="c2"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c10">commands:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c9">- fastlane android beta</span></p></td></tr></tbody></table><p class="c28 c25"><span class="c12 c48"></span></p><p class="c28"><span class="c22">In the following example, if a developer pushes a tag named </span><span class="c15 c8">release-v1.05</span><span class="c22">, the command </span><span class="c8 c15">fastlane android beta</span><span class="c9">&nbsp;</span><span class="c22">runs</span><span class="c12 c9">.</span></p><p class="c28 c25"><span class="c12 c9"></span></p><p class="c57 c47"><span class="c36 c60 c42">Note :</span><span class="c22">&nbsp;Change </span><span class="c33 c23">owner</span><span class="c22">&nbsp;from </span><span class="c23 c33">circleci</span><span class="c12 c22">&nbsp;to the username or organization that the repo belongs to or your build won&rsquo;t run.</span></p><p class="c0"><span class="c12 c22"></span></p><p class="c0"><span class="c12 c22"></span></p><ol class="c24 lst-kix_60m7zrvjlgl0-0" start="9"><li class="c5"><h2 id="h.m7b18az1g050" style="display:inline"><span class="c7">General configuration</span></h2></li></ol><p class="c29"><span class="c22">CircleCI by default tests every push to </span><span class="c22 c8">any</span><span class="c12 c22">&nbsp;branch in the repository.</span></p><p class="c28 c25"><span class="c12 c22"></span></p><p class="c27 c66"><span class="c22">You may, however, blacklist branches from being built in CircleCI. This example excludes </span><span class="c33 c23">gh-pages</span><span class="c12 c22">&nbsp;from being built in circle:</span></p><a id="t.e4a8abf3218bf1a48d1aff65e3f0a05d117c3062"></a><a id="t.7"></a><table class="c11"><tbody><tr class="c31"><td class="c37" colspan="1" rowspan="1"><p class="c2"><span class="c10">general:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; branches:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp;ignore:</span></p><p class="c2"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- gh-pages &nbsp; &nbsp; &nbsp; </span><span class="c50 c33 c32 c8 c51"># list of branches to ignore</span></p><p class="c2"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- /release\/.*/ &nbsp; &nbsp;</span><span class="c33 c32 c8 c51"># or ignore regexes</span></p></td></tr></tbody></table><p class="c63 c66"><span class="c22">You may also whitelist branches, so only whitelisted branches will trigger a build. This example limits builds in CircleCI to </span><span class="c33 c23">Development</span><span class="c22">&nbsp;and </span><span class="c33 c23">feature-.*</span><span class="c12 c22">&nbsp;branches:</span></p><a id="t.7c46d64498e205f82adf38ee9616f28f541403a9"></a><a id="t.8"></a><table class="c68"><tbody><tr class="c31"><td class="c56" colspan="1" rowspan="1"><p class="c2"><span class="c10">general:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; branches:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp;only:</span></p><p class="c2"><span class="c9">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;- Development &nbsp; &nbsp; </span><span class="c50 c33 c32 c8 c51"># list of branches to build</span></p><p class="c2"><span class="c9 c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c9">- /feature-.*/ &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c33 c32 c8 c51"># or regexes</span></p></td></tr></tbody></table><p class="c0"><span class="c12 c22"></span></p><p class="c0"><span class="c12 c22"></span></p><ul class="c24 lst-kix_n0u64i5tioth-0"><li class="c44"><h1 id="h.tft6crxvhxvf" style="display:inline"><span class="c52 c23">Example file of </span><span class="c52 c23 c8">CircleCI</span></h1></li></ul><a id="t.4fdca393c62e6777ad20faab3b991135ff91ded6"></a><a id="t.9"></a><table class="c59"><tbody><tr class="c31"><td class="c3" colspan="1" rowspan="1"><p class="c2 c25"><span class="c35 c21 c58"></span></p><p class="c2"><span class="c10">general:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; branches:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp;only:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c13">- Development </span><span class="c50 c18 c8"># or regexes</span></p><p class="c2"><span class="c18 c8">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">- Production</span></p><p class="c2 c25"><span class="c6"></span></p><p class="c2"><span class="c13">&nbsp;</span><span class="c10">artifacts:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; </span><span class="c6">- app/build/outputs/apk/</span></p><p class="c2 c25"><span class="c6"></span></p><p class="c2"><span class="c10">dependencies:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; &nbsp; pre:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c50 c18 c8"># Install the android packages</span></p><p class="c2"><span class="c8 c18">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">- echo y | android update sdk --no-ui --all --filter &quot;platform-tools,build-tools-25.0.2,android-25,sys-img-armeabi-v7a-android-25,extra-android-support,extra-google-google_play_services,extra-google-m2repository,extra-android-m2repository&quot;</span></p><p class="c2"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp;- gem install fastlane</span></p><p class="c2"><span class="c13">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c18 c8 c50"># Test lanes</span></p><p class="c2"><span class="c18 c8">&nbsp; &nbsp; &nbsp; </span><span class="c6">- fastlane lanes</span></p><p class="c2"><span class="c6">&nbsp; &nbsp; &nbsp; - sudo apt-get install sendmail</span></p><p class="c2"><span class="c13">&nbsp; &nbsp; &nbsp;</span><span class="c10">cache_directories:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; </span><span class="c13">- </span><span class="c35 c30 c33 c76">&quot;/opt/circleci/.rvm/gems&quot;</span></p><p class="c2 c25"><span class="c26"></span></p><p class="c2"><span class="c10">compile:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; override:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c50 c18 c8"># Generate a debug-apk</span></p><p class="c2"><span class="c18 c8">&nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c6">- ./gradlew assembleDevelopmentDebug</span></p><p class="c2 c25"><span class="c6"></span></p><p class="c2"><span class="c10">test:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp;post:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">- mkdir $CIRCLE_ARTIFACTS/apks</span></p><p class="c2"><span class="c13">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c13 c8"># </span><span class="c18 c8">Download gdrive and give user the execute permissions</span></p><p class="c2"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp;- curl -L -o gdrive &quot;https://docs.google.com/uc?id=0B3X9GlR6EmbnQ0FtZmJJUXEyRTA&amp;export=download&quot;; chmod +x gdrive</span></p><p class="c2"><span class="c13">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c13 c8">&nbsp;# </span><span class="c18 c8">Upload file to gdrive</span></p><p class="c2"><span class="c6">&nbsp; &nbsp; &nbsp; &nbsp;- ./gdrive --refresh-token &quot;${GDRIVE_REFRESH_TOKEN}</span></p><p class="c2"><span class="c6">&quot; upload --parent &quot;${GDRIVE_DIR_ID}&quot; &nbsp;app/build/outputs/apk/app-development-debug.apk</span></p><p class="c2 c25"><span class="c6"></span></p><p class="c2"><span class="c10">deployment:</span></p><p class="c2"><span class="c10">&nbsp; &nbsp; &nbsp; &nbsp;beta:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; branch: </span><span class="c6">Production</span></p><p class="c2"><span class="c13">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </span><span class="c10">commands:</span></p><p class="c2"><span class="c21 c30">&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</span><span class="c6">- fastlane android beta</span></p></td></tr></tbody></table><p class="c14 c25"><span class="c12 c4"></span></p><p class="c14"><span class="c4">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;In the above example, the when the code is pushed on </span><span class="c15 c8">Development</span><span class="c4">&nbsp;or </span><span class="c15 c8">Production</span><span class="c4">&nbsp;branch, circleci will start triggering the build. Also the </span><span class="c15 c8">build(apk)</span><span class="c4">&nbsp;is created and uploaded on </span><span class="c15 c8">google drive</span><span class="c4">. If the code is merged on </span><span class="c15 c8">Production</span><span class="c4">&nbsp;branch, </span><span class="c55 c33 c36 c8"><a class="c19" href="https://www.google.com/url?q=https://docs.fastlane.tools/getting-started/android/setup/&amp;sa=D&amp;ust=1492671534714000&amp;usg=AFQjCNGtcuqA3Fm0MJU6Mvj55zYX7un4Tg">fastlane</a></span><span class="c4">&nbsp;will upload the build to beta in </span><span class="c15 c8">google play store</span><span class="c12 c4">.</span></p><p class="c14"><span class="c1 c35">For uploading to google drive -</span></p><p class="c14"><span class="c4">Install </span><span class="c55 c33 c36"><a class="c19" href="https://www.google.com/url?q=https://github.com/prasmussen/gdrive&amp;sa=D&amp;ust=1492671534716000&amp;usg=AFQjCNEwZVlElxMt0YKcsU3FDJTnmijIZg">gdrive</a></span><span class="c4">&nbsp;from terminal : </span></p><a id="t.f8ee0982fd4f93507f279cbd3ea474d3119c3651"></a><a id="t.10"></a><table class="c67"><tbody><tr class="c31"><td class="c37" colspan="1" rowspan="1"><p class="c14"><span class="c50 c4 c8">brew install gdrive</span></p><p class="c14"><span class="c4 c8">gdrive info &ldquo;</span><span class="c13">${GDRIVE_DIR_ID}</span><span class="c50 c4 c8">&rdquo;</span></p><p class="c14"><span class="c50 c4 c8">Enter the verification code from the url given &nbsp;</span></p><p class="c27"><span class="c4 c8">After entering the verification code, it will generate the .gdrive folder in home directory.</span></p></td></tr></tbody></table><p class="c14 c25"><span class="c50 c4 c8"></span></p><p class="c27"><span class="c21 c30">GDRIVE_REFRESH_TOKEN </span><span class="c12 c4">is taken from the json file (hidden file) present in ./gdrive folder of home directory</span></p><p class="c14"><span class="c21 c30">GDRIVE_DIR_ID</span><span class="c13">&nbsp;</span><span class="c12 c4">is the parent id of the folder from google drive.</span></p><p class="c14 c25"><span class="c12 c4"></span></p><ul class="c24 lst-kix_2jbeks5ouv9q-0 start"><li class="c44"><h1 id="h.31ba879h4o37" style="display:inline"><span class="c52 c23">References</span></h1></li></ul><ul class="c24 lst-kix_r729vqhrgqc-0 start"><li class="c29 c72"><span class="c55"><a class="c19" href="https://www.google.com/url?q=https://circleci.com/docs/1.0/configuration/&amp;sa=D&amp;ust=1492671534727000&amp;usg=AFQjCNFNIePip7lTzn9IEYxUhx7kErIOmA">https://circleci.com/docs/1.0/configuration/</a></span></li><li class="c29 c72"><span class="c55"><a class="c19" href="https://www.google.com/url?q=https://github.com/prasmussen/gdrive&amp;sa=D&amp;ust=1492671534728000&amp;usg=AFQjCNFlenC-ec4i5BZ96H0qwM6VaoVtmw">https://github.com/prasmussen/gdrive</a></span></li></ul><p class="c0"><span class="c12 c48"></span></p>
</div>
